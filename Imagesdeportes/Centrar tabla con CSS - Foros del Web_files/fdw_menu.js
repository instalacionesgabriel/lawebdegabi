var fdwMenus={initialized:false,timer:1000,hideTimer:null,init:function(){YAHOO.util.Event.on(document,"click",this.hide,this,true);this.initialized=true},menus:[],register:function(f,b,a,e,d,c){if(!this.initialized){this.init()}this.menus[f]={id:f,side:b,button:document.getElementById(f),ajax:d};if(a==undefined||a===false){this.menus[f].menu=document.getElementById(f+"_menu")}else{this.menus[f].menu=document.getElementById(a+"_menu")}this.menus[f].menu.style.position="absolute";if(e==undefined||e===false){YAHOO.util.Event.on(this.menus[f].button,"click",this.click,this.menus[f],true)}YAHOO.util.Event.on(this.menus[f].button,"mouseover",this.mouseover,this.menus[f],true);if(!c){YAHOO.util.Event.on(this.menus[f].button,"mouseout",this.menuLeave,this,true)}if(!this.menus[f].menu.hookEvents){this.menus[f].menu.hookEvents=true;if(!c){YAHOO.util.Event.on(this.menus[f].menu,"mouseover",this.menuEnter,this,true);YAHOO.util.Event.on(this.menus[f].menu,"mouseout",this.menuLeave,this,true)}YAHOO.util.Event.on(this.menus[f].menu,"click",function(g){YAHOO.util.Event.stopPropagation(g)})}},click:function(a){if(fdwMenus.active==this.id){fdwMenus.hide()}else{fdwMenus.show(this.id)}YAHOO.util.Event.stopEvent(a)},menuEnter:function(){if(this.hideTimer){clearTimeout(this.hideTimer)}},menuLeave:function(){this.hideTimer=setTimeout(this.hideFunc,this.timer)},mouseover:function(a){fdwMenus.show(this.id)},show:function(c){this.hide();this.menuEnter();var d=this.menus[c];this.active=c;YAHOO.util.Dom.replaceClass(d.button,"menulink","menuactive");if(d.ajax&&!d.menu.loaded){this.fetchMenu(d);return}var a=YAHOO.util.Dom.getRegion(d.button);d.menu.style.display="block";var b=YAHOO.util.Dom.getRegion(d.menu);if(b.width<150){d.menu.style.width="150px";b.width=150}if(d.side==true){var e=[a.right-b.width,a.bottom-1]}else{var e=[a.left,a.bottom-1]}YAHOO.util.Dom.setXY(d.menu,e)},fetchMenu:function(a){if(YAHOO.util.Connect.isCallInProgress(a.ajax.request)){return}a.button.style.cursor="wait";a.ajax.request=YAHOO.util.Connect.asyncRequest("POST",a.ajax.url,{success:this.fetchHandler,failure:this.fetchFailure,timeout:vB_Default_Timeout,scope:a},"ajax=1&securitytoken="+SECURITYTOKEN)},fetchHandler:function(a){if(a.responseXML){var c=null;var b=null;if(c=a.responseXML.getElementsByTagName(this.ajax.tagname)[0]){c=c.firstChild.nodeValue;this.menu.innerHTML=fdwAjaxEval.stripScripts(c);fdwAjaxEval.evalScripts(c)}if(b=a.responseXML.getElementsByTagName("error")[0]){this.menu.innerHTML=b.firstChild.nodeValue}this.button.style.cursor="default";this.menu.loaded=true;if(fdwMenus.active==this.id){fdwMenus.show(this.id)}}},fetchFailure:function(a){vBulletin_AJAX_Error_Handler(a);location.href=this.ajax.url},hide:function(){if(this.active===null){return}var a=this.menus[this.active];YAHOO.util.Dom.replaceClass(a.button,"menuactive","menulink");a.menu.style.display="none";this.active=null},hideFunc:function(){fdwMenus.hide()},active:null};